<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Divya Engineering Delivery Challan Details</title>
        <script src="jquery.js"></script>
        <script src="jquery.validate.js"></script>

 <style type="text/css">
* { font-family: Verdana; font-size: 96%; }
label { width: 10em; float: left; color: black}
label.error { float: none; color: red; padding-left: .5em; vertical-align: top; }
p { font-weight: bold; clear: both; }
.submit { margin-left: 12em; }
.drawingqty{border-spacing=2px;
color: #ffffff;
} 

</style>
  <script>
$(document).ready(function(){
  	$("#customer").load('get_customer.php');

    $("#deliverychallen").validate();

$('#added').hide();
$('#cdate').validate({
        rules :{
            cdate : {
                required: true,
                indianDate: true
                
                         }
             },
    });

	$("#submit").click(function(event) {
		 if($("#deliverychallen").valid())
		  	{
		  		event.preventDefault();
				$.ajax({
      					data: $('#deliverychallen').serializeArray(),
      					type: "POST",
      					url: "outward_dc.php",
      					success: function(html) {
						document.getElementById("footer").innerHTML=html;
						$('#deliverychallen')[0].reset();
      							}
    								});
 	
		  	}

	});
var noofcomp=0;
var data=new Array();
$('#customer').click(function(){
noofcomp=0;
	var custid=$('#Customer_ID').val();
var url='get_drawing_dc.php?custid='+custid+'&noofcomp='+noofcomp;
  		$("#Drawing_ID").load(url)
$('#noofcomp').val(noofcomp);
  		noofcomp++;
  		});


$('#add').click(function(){
	var drawingid=$('#Drawing').val();
	var incommingid=$('#Challan_ID').val();
	var qty=$('#qty').val();
	var Max_Qty=0;
	var url='get_challan_qty.php?drawingid='+drawingid+'&incommingid='+incommingid+'&qty='+qty;
	$.get(url, function(result) {
if(result<qty){alert("Please enter Correct Quantity");
return false;}
		});

		if(drawingid==''||incommingid==''||qty=='')
		{
			alert("Please select Corect Drawing, Challan No and Quantity");
			return false;
		}else	{
		var url='get_comp_challan_details.php?drawingid='+drawingid+'&incommingid='+incommingid+'&qty='+qty;
		$.get(url, function(result) {
   		data[noofcomp]=result.split("<|>")
		var newtr="<tr><td>"+data[noofcomp][0]+"</td><td>"+data[noofcomp][1]+"</td><td>"+data[noofcomp][2]+"</td><td>"+data[noofcomp][3]+"</td><td>"+data[noofcomp][4]+"</td><td>"+data[noofcomp][5]+"</td><td>"+data[noofcomp][6]+"</td><td>"+data[noofcomp][7]+"</td></tr>";
		$('#added').show();
		$('#added').append(newtr);
		$('#data').val(data);
		$('#noofcomp').val(noofcomp);
   		noofcomp++;
		});



}


  	});

$('#Drawing_ID').change(function(){
	var drawingid=$('#Drawing').val();
	var url='get_open_challans.php?drawingid='+drawingid;
  		$('#challan').load(url)
  		});



  });




function indianDate(value, element) {	

var dm=/^(0[1-9]|[12][0-9]|3[01])[- //.](0[1-9]|1[012])[- //.](19|20)\d\d$/;
                return value.match(dm);
}

$.validator.addMethod("indianDate",indianDate,"Please enter a date in the format dd/mm/yyyy");




  </script>




    </head>
    <body>
<div id="adraw">
  <form class="cmxform" id="deliverychallen">
 <fieldset>
<legend>Add Outgoing Material Details</legend>
   <p>
     <label for="cname">Customer's Name</label>
     <div id="customer"></div>
   </p>
   <p>
   	     <div id="Drawing_ID" class="drawingqty"></div>
   </p>
   <p>
     <div id="challan"></div>
   </p>
     <input id="add" name="add" type="button" value="Add To List"/>
   <p>
     <input id="noofcomp" name="noofcomp" size="25" value="" type="hidden"/>
     <input id="data" name="data" value="" type="hidden"/>
   </p>

 </fieldset>
   <p>
     <input class="submit" id="submit" type="submit" value="Submit"/>
   </p>

 </form>
</div>
<div id="footer"></div>
<table id="added" border="1px" cellspacing="2px">
<tr><th>Drawing No</th><th>Ex Challan No</th><th>Ex Challan Date</th><th>Gate Pass No</th><th>Gate Pass Date</th><th>DA No</th><th>da date</th><th>Qty</th></tr>	
	
	
</table>	


</body>
</html>
